!function(t,e){"use strict";function o(t){var o=this,r=[{key:t.container,value:"请传入canvas元素id"}];o.environment(r),o.container=e.selector(t.container),o=e.extend({},n,t,o);var i=o.container,a=i.getContext("2d");i.width=o.cw,i.height=o.ch,o.offsetTop=i.offsetTop;var l=(o.cw-2*o.offsetX-2*o.r*3)/2,f=(o.ch-2*o.offsetY-2*o.r*3)/2;o.pointArr=o._drawLocalPoint(l,f),o._initListeners(i,a,t.itemClick),o._draw(o.pointArr,[],null,a)}var n={r:26,cw:t.body.offsetWidth,ch:320,offsetX:15,offsetY:15,outRoundBorderColor:"#666",lineWidth:"7",lineColor:"#f00",outRoundColor:"#fff",innerRoundColor:"#008080",itemClick:function(t){}};o.prototype={_drawLocalPoint:function(t,e){for(var o=[],n=this,r=n.offsetX,i=n.offsetY,a=n.r,l=0;l<3;l++)for(var f=0;f<3;f++){var c={x:r+f*t+(2*f+1)*a,y:i+l*e+(2*l+1)*a};o.push(c)}return o},environment:function(t){for(var e=0,o=t.length;e<o;e++)if(!t[e].key)throw new Error(t[e].value)},_initListeners:function(t,e,o){var n=[],r=this;t.addEventListener("touchstart",function(t){r._selectPoint(t.touches[0],n)}),t.addEventListener("touchmove",function(t){t.preventDefault();var o=t.touches[0];r._selectPoint(o,n),e.clearRect(0,0,r.cw,r.ch),r._draw(r.pointArr,n,{x:o.pageX,y:o.pageY-r.offsetTop},e)}),t.addEventListener("touchend",function(t){e.clearRect(0,0,r.cw,r.ch),r._draw(r.pointArr,n,null,e),o.call(r,n),n=[]})},_selectPoint:function(t,e){for(var o=this.pointArr,n=0,r=o.length;n<r;n++){var i=o[n],a=Math.abs(i.x-t.pageX),l=Math.abs(i.y-(t.pageY-this.offsetTop)),f=Math.pow(a*a+l*l,.5);if(f<this.r){e.indexOf(n)<0&&e.push(n);break}}},_draw:function(t,e,o,n){var r=this,i=r.r,a=2*Math.PI;if(e.length>0){n.beginPath();for(var l=0,f=e.length;l<f;l++){var c=e[l];n.lineTo(t[c].x,t[c].y)}if(n.lineWidth=r.lineWidth,n.strokeStyle=r.lineColor,n.stroke(),n.closePath(),null!=o){var h=e[e.length-1],s=t[h];n.beginPath(),n.moveTo(s.x,s.y),n.lineTo(o.x,o.y),n.stroke(),n.closePath()}}for(var l=0,f=t.length;l<f;l++){var u=t[l];n.fillStyle=r.outRoundBorderColor,n.beginPath(),n.arc(u.x,u.y,i,0,a,!0),n.closePath(),n.fill(),n.fillStyle=r.outRoundColor,n.beginPath(),n.arc(u.x,u.y,i-3,0,a,!0),n.closePath(),n.fill(),e.indexOf(l)>=0&&(n.fillStyle=r.innerRoundColor,n.beginPath(),n.arc(u.x,u.y,i-16,0,a,!0),n.closePath(),n.fill())}}},window.GridUnlock=o}(document,window.Util);