!function(){"use strict";function o(o){o=Util.extend({},i,o),this.container=Util.selector(o.container),this.options=o,this._render(),this.update()}var t="https:"==document.location.protocol,i={container:"#baidumap",isSupportGeolocation:!1,isForceDD:!1,longitude:120.61990712,latitude:31.31798737};o.prototype={_render:function(){var o=new BMap.Point(this.options.longitude,this.options.latitude);this.currPoint=o,this.myGeo=new BMap.Geocoder,this.map=new BMap.Map(this.container),this.map.centerAndZoom(o,12)},_updateLocation:function(o){var t=this.map;t.centerAndZoom(o,16),t.enableScrollWheelZoom(!0);var i=new BMap.Marker(o);t.addOverlay(i),t.panTo(o),this.currPoint=o},_changeBDPointByGeolocationLocation:function(o,t,i,n){if("object"==typeof arguments[0])return void(i&&i(arguments[0]));n=n||!1;var e=new BMap.Point(o,t),a=new BMap.Convertor,c=[];c.push(e);var s=n?1:3;a.translate(c,s,5,function(o){var t=e;o&&0===o.status&&o.points&&(t=o.points[0]),i&&i(t)})},_getLocationByDD:function(o,t){dd.device.geolocation.get({targetAccuracy:200,coordinate:0,withReGeocode:!1,onSuccess:function(t){o&&o(t.longitude,t.latitude)},onFail:function(o){t&&t("钉钉获取坐标失败")}})},_getLocationByGeolocation:function(o,t){navigator.geolocation.getCurrentPosition(function(t){o&&o(t.coords.longitude,t.coords.latitude)},function(o){switch(o.code){case o.PERMISSION_DENIED:o&&o("用户拒绝对获取地理位置的请求");break;case o.POSITION_UNAVAILABLE:o&&o("位置信息是不可用的。");break;case o.TIMEOUT:o&&o("请求用户地理位置超时。");break;case o.UNKNOWN_ERROR:o&&o("未知错误。")}})},_getLocationByBDBrowser:function(o,t){var i=new BMap.Geolocation;i.getCurrentPosition(function(i){self.map;this.getStatus()==BMAP_STATUS_SUCCESS?o&&o(i.point):t&&t("failed"+this.getStatus())},{enableHighAccuracy:!0})},_location:function(){var o=this;o.getLocation(function(t){o._updateLocation(t),o.options.success&&o.options.success(t)},o.options.error)},getLocation:function(o,i){var n=this.options,e=this,a=function(t,i){t=t||n.longitude,i=i||n.latitude,e._changeBDPointByGeolocationLocation(t,i,o)};n.isForceDD&&Util.os.dd&&window.dd?this._getLocationByDD(a,i):navigator.geolocation&&t&&n.isSupportGeolocation?this._getLocationByGeolocation(a,i):this._getLocationByBDBrowser(a,i)},update:function(o){this.options=Util.extend(this.options,o),this._location()},searchHotPoint:function(o){var t=this;o=o||{},o.poiRadius=o.poiRadius||1e3,o.numPois=o.numPois||12,t.myGeo.getLocation(t.currPoint,function(t){var i=t.surroundingPois;o.success&&o.success(i)},o)},destroy:function(){this.container=null,this.options=null,this.currPoint=null,this.myGeo=null,this.map=null}},window.BaiduMap=o}();