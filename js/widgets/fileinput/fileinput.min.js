!function(){"use strict";function e(e,t,i,a,n){return!window.FileReader&&e&&e instanceof FileReader?void(a&&a("错误:FileReader不存在!")):(e.onload=function(e){var a=e.target.result;if("DataUrl"===n&&a&&a.indexOf("data:base64,")!==-1){a=a.replace("data:base64,","");var r="",l=t.name;l&&l.toLowerCase().indexOf(".jpg")!==-1?r="image/jpeg":l&&l.toLowerCase().indexOf(".png")!==-1?r="image/png":l&&l.toLowerCase().indexOf(".gif")!==-1?r="image/gif":l&&l.toLowerCase().indexOf(".icon")!==-1&&(r="image/x-icon"),a="data:"+r+";base64,"+a}i&&i(a)},e.onerror=function(e){e&&e(e)},"DataUrl"===n?e.readAsDataURL(t):"Text"===n?e.readAsText(t):e.readAsBinaryString(t),e)}function t(e){e=Util.extend({},i,e),this.container=Util.selector(e.container),this.options=e,this._init(),this._addEvent()}var i={type:"ALL",isMulti:!1,container:""};t.prototype={_init:function(){var e=Util.os.ejs,t=this.options,i=this.container;i.setAttribute("type","file"),t.isMulti?i.setAttribute("multiple","multiple"):i.removeAttribute("multiple");var a,n=t.accept||i.getAttribute("accept"),r=t.type||"File";"Image"===r?(a="image/*",r="DataUrl"):"Camera"===r?(a=e?"camera/*":"image/*",r="DataUrl"):"Image_Camera"===r?(a=e?"image_camera/*":"image/*",r="DataUrl"):"Image_File"===r?(a=e?"image_file/*":"*",r="DataUrl"):"Camera_File"===r?(a=e?"camera_file/*":"*",r="DataUrl"):"Text"===r?(a=e?"text/*":"file/*",r="Text"):"File"===r?e?(a="file/*",r="DataUrl"):(a="*",r="File"):"All"===r?e?(a="*/*",r="DataUrl"):(a="*",r="DataUrl"):(a="*",r="File"),this.dataType=r,a=n||a,i.setAttribute("accept",a)},_addEvent:function(){var t=this.container,i=this.options,a=i.success,n=i.error,r=this,l=function(){var i=t.files,l=i.length;if(0!==l){var o=new window.FileReader,s=0,c=function(){s>=l||e(o,i[s],function(e){a&&a(e,i[s],{index:s,len:l,isEnd:s>=l-1}),s++,c()},n,r.dataType)};c()}};t.addEventListener("change",l),this.delegatesHandle=l},destroy:function(){this.container.removeEventListener("change",this.delegatesHandle),this.container=null,this.options=null}},window.FileInput=t}();