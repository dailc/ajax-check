!function(){"use strict";function t(t){t=Util.extend({},i,t),this.options=t,this.container=Util.selector(t.container),this.width=this.container.width,this.height=this.container.height,this.ctx=this.container.getContext("2d"),this.ctx.textBaseline="bottom",this.update(),this._addEvent()}var i={container:"#verifycode",len:4,minfontsize:20,maxfontsize:35,radius:1,top:.92,bottom:.92};t.prototype={_render:function(){this.ctx.fillStyle=this._changeColor(this.options.bgColor)||this._randomColor(200,240),this.ctx.fillRect(0,0,this.width,this.height),this._createCode(),this._draw()},_addEvent:function(){var t=this;t.clickFunc=function(){t.update.call(t)},t.container.addEventListener("click",t.clickFunc)},_createCode:function(){this.code=this._randStr(this.options.len)},_draw:function(){if(this.container){for(var t=0;t<this.options.len;t++){var i=(this.width-20)/this.options.len*t+15,n=this._randomNum(this.height*this.options.top,this.height*this.options.bottom),o=this._randomNum(-45,45),s=this.code.charAt(t);this.ctx.fillStyle=this._changeColor(this.options.colors&&this.options.colors[t])||this._randomColor(10,100),this.ctx.font=this._randomNum(this.options.minfontsize,this.options.maxfontsize)+"px SimHei",this.ctx.translate(i,n),this.ctx.rotate(o*Math.PI/180),this.ctx.fillText(s,0,0),this.ctx.rotate(-o*Math.PI/180),this.ctx.translate(-i,-n)}for(var t=0;t<this.options.len;t++)this.ctx.strokeStyle=this._randomColor(90,180),this.ctx.beginPath(),this.ctx.moveTo(this._randomNum(0,this.width),this._randomNum(0,this.height)),this.ctx.lineTo(this._randomNum(0,this.width),this._randomNum(0,this.height)),this.ctx.stroke();for(var t=0;t<10*this.options.len;t++)this.ctx.fillStyle=this._randomColor(0,255),this.ctx.beginPath(),this.ctx.arc(this._randomNum(0,this.width),this._randomNum(0,this.height),this.options.radius,0,2*Math.PI),this.ctx.fill()}},_changeColor:function(t){if(t){/^#/.test(t)&&(t=t.substr(1));var i=t.substr(0,2),n=t.substr(2,2),o=t.substr(4,2);return i&&n&&o?"rgba("+parseInt(i,16)+","+parseInt(n,16)+","+parseInt(o,16)+",1)":void 0}},_randomColor:function(t,i){var n=this._randomNum(t,i),o=this._randomNum(t,i),s=this._randomNum(t,i);return"rgba("+n+","+o+","+s+",1)"},_randomNum:function(t,i){return Math.floor(Math.random()*(i-t)+t)},_randStr:function(t){return Util.uuid({type:"noline",len:t})},update:function(){this.container&&this._render()},validate:function(t){return this.code.toLowerCase()===t},destroy:function(){this.container.removeEventListener("click",this.clickFunc),this.clickFunc=null,this.options=null,this.container=null,this.width=null,this.height=null,this.ctx=null,this.code=null}},window.VerifyCode=t}();